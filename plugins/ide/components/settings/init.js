!function(t,l){l(function(){codiad.settings.init()}),codiad.settings={controller:"components/settings/controller.php",init:function(){l("body").append('<iframe src="components/settings/dialog.php?action=iframe"></iframe>'),this.load()},save:function(){var t,e={},a=/^codiad/,i=/^codiad.plugin/;amplify.publish("settings.save",{});var s="true"==localStorage.getItem("codiad.settings.system.sync"),n="true"==localStorage.getItem("codiad.settings.plugin.sync");if(s||n)for(var o=0;o<localStorage.length;o++)t=localStorage.key(o),a.test(t)&&!i.test(t)&&s&&(e[t]=localStorage.getItem(t)),i.test(t)&&n&&(e[t]=localStorage.getItem(t));e["codiad.settings.system.sync"]=s,e["codiad.settings.plugin.sync"]=n,l.post(this.controller+"?action=save",{settings:JSON.stringify(e)},function(t){parsed=codiad.jsend.parse(t)})},load:function(){l.get(this.controller+"?action=load",function(t){parsed=codiad.jsend.parse(t),"error"!=parsed&&(l.each(parsed,function(t,e){localStorage.setItem(t,e)}),amplify.publish("settings.loaded",parsed))})},show:function(t){var e=this;codiad.modal.load(800,"components/settings/dialog.php?action=settings"),codiad.modal.hideOverlay(),codiad.modal.load_process.done(function(){"string"==typeof t?codiad.settings._showTab(t):e._loadTabValues("components/settings/settings.editor.php"),amplify.publish("settings.dialog.show",{})})},_showTab:function(e){var a=this;if("string"!=typeof e)return!1;l(".settings-view .config-menu .active").removeClass("active"),l('.settings-view .config-menu li[data-file="'+e+'"]').addClass("active"),l(".settings-view .panels .active").hide().removeClass("active"),0===l('.settings-view .panel[data-file="'+e+'"]').length?(l(".settings-view .panels").append('<div class="panel active" data-file="'+e+'"></div>'),l('.settings-view .panel[data-file="'+e+'"]').load(e,function(){var t=l('.settings-view .config-menu li[data-file="'+e+'"]').attr("data-name");amplify.publish("settings.dialog.tab_loaded",t),a._loadTabValues(e)})):l('.settings-view .panel[data-file="'+e+'"]').show().addClass("active")},_loadTabValues:function(t){var a,i;l('.settings-view .panel[data-file="'+t+'"] .setting').each(function(t,e){a=l(e).attr("data-setting"),null!==(i=localStorage.getItem(a))&&l(e).val(i)})}}}(0,jQuery);